# بررسی موقعیت و سهم نمایش سایت‌ها در نتایج جستجوی گوگل با استفاده از Serper.dev

این پروژه با استفاده از API سرویس [Serper.dev](https://serper.dev) موقعیت (Position) و سهم نمایش (SOV - Share of Voice) سایت‌های مختلف را در نتایج جستجوی گوگل برای مجموعه‌ای از کلمات کلیدی تحلیل می‌کند.

---

## 📌 امکانات

- بررسی موقعیت سایت‌ها در ۲۰ نتیجه اول گوگل
- پشتیبانی از چند کلید API
- محاسبه سهم نمایش واقعی (SOV) با استفاده از CTR و سرچ ولوم
- خروجی به فرمت Excel
- نمودار دایره‌ای برای نمایش سهم رقبا

---

## 🚀 نحوه استفاده

1 . **فایل اکسل خود را آماده کنید**. این فایل باید حداقل دارای یک ستون با عنوان `کلمه کلیدی` باشد. ستون `سرچ ولوم` نیز اختیاری است اما برای محاسبه **SOV** مورد استفاده قرار می‌گیرد.
   
2 . **وارد  [Google Colab](https://colab.research.google.com/drive/1xedEmK67jWu0kbZLa6mCPTFHZoNzF51D?usp=sharing) شوید**.

3 . **فایل اکسل را آپلود کرده و کد را اجرا کنید**.

4 . پس از پردازش، فایل خروجی با نام `نتایج_کلمات_کلیدی_با_پوزیشن.xlsx` در اختیار شما قرار خواهد گرفت.

5 . **در پایان، سهم نمایش سایت‌ها به‌صورت عددی و نموداری نمایش داده خواهد شد**.

---

## 📝 فرمت فایل اکسل ورودی

فایل اکسل باید حداقل شامل یک ستون با نام `کلمه کلیدی` و یک ستون `سرچ ولوم` باشد،

## 🌐 دامنه‌های بررسی‌شده
در ابتدای کد، لیستی از دامنه‌ها مشخص شده که موقعیت آن‌ها در نتایج جستجو بررسی می‌شود. این لیست را می‌توانید به دلخواه تغییر دهید:

```
sites_to_check = [
    "site1.com",
    "site2.com",
    "site3com",
    "site4.com",
    "site5.com",
    "site6.com",
    "site7.com"
]
```
## 🔑 استفاده از کلیدهای API
برای استفاده از Serper.dev باید API Keyهای معتبر وارد کنید. این کلیدها به صورت زیر در کد تعریف می‌شوند:

```
API_KEYS = [
    "کلید اول",
    "کلید دوم",
    ...
]
```
هر کلید تا ۱۲۰۰ درخواست را پشتیبانی می‌کند. در صورت رسیدن به سقف، کد به‌صورت خودکار به کلید بعدی سوییچ می‌کند.


## 📤 خروجی نهایی
پس از پردازش، فایل اکسل با نام نتایج_کلمات_کلیدی_با_پوزیشن.xlsx تولید خواهد شد. این فایل شامل موارد زیر است:
-  موقعیت سایت‌ها برای هر کلمه کلیدی: اطلاعات مربوط به اینکه هر سایت در کجا در نتایج جستجو قرار دارد.
-  سهم نمایش (SOV) به‌ازای هر سایت: محاسبه سهم نمایش سایت‌ها بر اساس موقعیت آن‌ها و حجم جستجو.
-  نمودار دایره‌ای: نمایش سهم نمایش رقبا به صورت تصویری.
